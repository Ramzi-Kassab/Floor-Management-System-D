{% extends 'base.html' %}

{% block title %}Task Status: {{ task_id }}{% endblock %}

{% block content %}
<h1>Task Status</h1>
<div class="card">
    <div class="card-header">
        <h5>{{ task_id }}</h5>
    </div>
    <div class="card-body">
        <h5 class="card-title">Workflow: {{ task.workflow_name }}</h5>
        <p class="card-text">
            Status: 
            {% if task.status == 'running' %}
            <span class="badge bg-primary">Running</span>
            {% elif task.status == 'completed' %}
            <span class="badge bg-success">Completed</span>
            {% elif task.status == 'failed' %}
            <span class="badge bg-danger">Failed</span>
            {% endif %}
        </p>
        
        {% if task.status == 'failed' and task.error %}
        <div class="alert alert-danger">
            <h6>Error:</h6>
            <pre>{{ task.error }}</pre>
        </div>
        {% endif %}
        
        <h6>Input Data:</h6>
        <pre class="bg-light p-3">{{ task.data|tojson(indent=2) }}</pre>
    </div>
</div>

<div class="mt-3">
    <a href="/tasks" class="btn btn-primary">View All Tasks</a>
    <a href="/workflows" class="btn btn-secondary">Back to Workflows</a>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Auto-refresh if the task is still running
    {% if task.status == 'running' %}
    setTimeout(function() {
        window.location.reload();
    }, 5000);  // refresh every 5 seconds
    {% endif %}
</script>
{% endblock %}